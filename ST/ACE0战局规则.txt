<ace0_battle_rules>
[ACE0 引擎协议 v2 — NPC 模块化组装]
ACE0引擎协议是一个德州扑克 × 命运对决的场景模拟器。
触发条件：仅当「牌局逻辑判定 (Battle_Logic_Active) = YES」时，生成纯 JSON 数据并包裹在 ACE0_BATTLE XML标签中。标签内禁输出无关文本。

核心原则：
1. 主角(hero)数据**不写入** —— 由系统从 ERA 变量自动注入。
2. AI 只需描述**"这是个什么人"**，系统自动展开为完整配置。
3. 座位标识符：UTG, HJ, CO, BTN, SB, BB（最多6个座位）。
4. NPC 由四个独立维度组装，只在最终生成 config 时缝合。

核心架构：NPC 四维度组装

一个 NPC = kernel(性格水平) + wealth(经济) + archetype(异能) + mood(情绪)
四个维度完全解耦，自由组合。

[维度1: AI 核心 (kernel) — 性格 + 水平]
- "mob"      — 杂鱼：被动+菜鸟，盲目跟注
- "gambler"  — 赌徒：疯狂+菜鸟，乱推 All-in
- "rock"     — 老苟：保守+老鸟，不见兔子不撒鹰
- "shark"    — 鲨鱼：激进+专家，剥削型打法，极难缠
- "boss"     — 魔王：均衡+专家，滴水不漏

[维度2: 经济阶级 (wealth) — 筹码 + 盲注]
- "poor"     — 贫民窟：500筹码，盲注 5/10
- "normal"   — 市民：2000筹码，盲注 20/40
- "rich"     — 富豪：10000筹码，盲注 100/200
- "whale"    — 巨鲸：50000筹码，盲注 500/1000

[维度3: 异能模版 (archetype) — RPG属性+技能]
- "muggle"     — 麻瓜/常人：无异能
- "lucky"      — 幸运儿：命运40（可用大吉）
- "cursed"     — 厄运散播者：混沌50（可用大凶、灾变）
- "esper"      — 灵能者：心智80（透视+真理）
- "nullifier"  — 抹杀者：虚空100（屏蔽+现实）

[维度4: 情绪修正 (mood) — 运行时覆写]
- "calm"       — 冷静（默认）
- "confident"  — 自信，敢打敢冲
- "tilt"       — 上头，情绪失控
- "fearful"    — 恐惧，畏手畏脚
- "desperate"  — 绝望，孤注一掷
- "euphoric"   — 狂喜，容易轻敌

===================================================================
方式一：跑龙套速记（最简，推荐用于杂兵/常见NPC）
===================================================================

每个座位只需 runner 名 + 自定义名字，系统自动展开四维度。

[跑龙套列表]
杂兵类:
- "street_thug"    — 街头小混混 (mob/poor/muggle/calm)
- "drunk"          — 醉汉赌徒 (gambler/poor/muggle/euphoric)
- "rookie"         — 紧张新手 (mob/normal/muggle/fearful)
常规对手:
- "tavern_regular" — 酒馆常客 (rock/normal/muggle/calm)
- "pro_gambler"    — 职业赌徒 (shark/normal/muggle/confident)
- "lucky_bastard"  — 运气王 (gambler/normal/lucky/euphoric)
精英/小Boss:
- "casino_shark"   — 赌场鲨鱼 (shark/rich/muggle/calm)
- "curse_dealer"   — 厄运荷官 (shark/rich/cursed/confident)
- "mind_reader"    — 读心者 (boss/rich/esper/calm)
Boss:
- "void_king"      — 虚空之王 (boss/whale/nullifier/confident)
- "chaos_lord"     — 混沌领主 (shark/whale/cursed/tilt)

[跑龙套格式]
{ "runner": "跑龙套名", "name": "自定义显示名" }

===================================================================
方式二：四维组装（通用，推荐用于有特色的NPC）
===================================================================

自由组合四个维度，不需要记住具体数值。

[四维组装格式]
{
  "name": "显示名",
  "kernel": "mob|gambler|rock|shark|boss",
  "wealth": "poor|normal|rich|whale",
  "archetype": "muggle|lucky|cursed|esper|nullifier",
  "mood": "calm|confident|tilt|fearful|desperate|euphoric"
}

===================================================================
方式三：原始直写（完全自定义，用于特殊Boss）
===================================================================

手动指定所有字段，系统透传不处理。

{
  "vanguard": { "name": "名称", "level": 0~5, "trait": "特质ID" },
  "rearguard": { "name": "副手", "level": 0~5, "trait": "特质ID" },
  "attrs": { "moirai": 0~100, "chaos": 0~100, "psyche": 0~100, "void": 0~100 },
  "skills": ["技能ID", ...],
  "ai": "balanced",
  "emotion": "calm"
}

===================================================================
根结构
===================================================================

<ACE0_BATTLE>
{
  "hero": {                       // 可选，指定本局主角阵容
    "vanguard": "角色名",         // 必填（主手），对应 ERA 中 hero.角色名
    "rearguard": "角色名"         // 可选（副手），省略 = 无副手模式
  },
  "wealth": "经济阶级",           // 可选，推导全局 blinds/chips
  "blinds": [小盲, 大盲],         // 可选，覆盖 wealth 推导值
  "chips": 初始筹码,               // 可选，覆盖 wealth 推导值
  "seats": {
    "座位ID": { NPC配置 },         // 三种格式任选
    ...
  }
}
</ACE0_BATTLE>

注意：
- 同一桌内三种 NPC 格式可以混用。
- hero.vanguard/rearguard 是本局阵容，不是永久状态。
- 省略 hero 字段时，系统自动使用 ERA 中第一个角色作为主手。

情绪使用指南

情绪应随剧情和牌局结果动态变化：
- 第一把 → calm 或 confident
- 输了大锅 → tilt 或 fearful
- 筹码快没了 → desperate
- 赢了大锅 → euphoric 或 confident

经典组合效果：
- rock + tilt = 平时保守的人突然失控，反差极大
- maniac + fearful = 疯子被打怕了，变得犹豫
- shark + confident = 最危险状态，精准施压
- mob + desperate = 鱼被逼到墙角，开始乱推

参考数据

[特质ID]
主手: blank_body, iron_nerve, wild_surge
副手: fate_weaver, hex_pulse

[技能ID（通用系统）]
命运系: minor_wish, grand_wish, divine_order
混沌系: hex, havoc, catastrophe
心智系: insight, vision, axiom
虚空系: static_field, insulation, reality

[属性三角克制]
chaos > moirai > psyche > chaos
void = 纯减伤，不参与克制

示例

示例1（全跑龙套 — 酒馆3人桌）：
<ACE0_BATTLE>
{
  "hero": {
    "vanguard": "KAZU",
    "rearguard": "RINO"
  },
  "wealth": "normal",
  "seats": {
    "BTN": { "runner": "tavern_regular", "name": "老张" },
    "SB": { "runner": "drunk", "name": "醉老李" }
  }
}
</ACE0_BATTLE>

示例2（四维组装 — 自定义鲨鱼）：
<ACE0_BATTLE>
{
  "hero": {
    "vanguard": "KAZU"
  },
  "wealth": "rich",
  "seats": {
    "BB": {
      "name": "黑寡妇",
      "kernel": "shark",
      "archetype": "cursed",
      "mood": "confident"
    }
  }
}
</ACE0_BATTLE>

示例3（混合格式 — 杂兵+Boss 同桌）：
<ACE0_BATTLE>
{
  "hero": {
    "vanguard": "KAZU",
    "rearguard": "RINO"
  },
  "blinds": [50, 100],
  "chips": 5000,
  "seats": {
    "UTG": { "runner": "street_thug", "name": "小喽啰A" },
    "CO": { "runner": "street_thug", "name": "小喽啰B" },
    "BB": {
      "name": "暗影领主",
      "kernel": "boss",
      "archetype": "nullifier",
      "mood": "calm"
    }
  }
}
</ACE0_BATTLE>

示例4（原始直写 — 特殊双角色Boss）：
<ACE0_BATTLE>
{
  "hero": {
    "vanguard": "RINO"
  },
  "blinds": [100, 200],
  "chips": 10000,
  "seats": {
    "BB": {
      "vanguard": { "name": "VOID_KING", "level": 5, "trait": "iron_nerve" },
      "rearguard": { "name": "VOID_QUEEN", "level": 4, "trait": "hex_pulse" },
      "attrs": { "moirai": 70, "chaos": 50, "psyche": 60, "void": 80 },
      "skills": ["grand_wish", "havoc", "vision"],
      "ai": "aggressive",
      "emotion": "tilt"
    }
  }
}
</ACE0_BATTLE>

示例5（多手牌 — 第二把情绪变化）：
<ACE0_BATTLE>
{
  "hero": {
    "vanguard": "KAZU",
    "rearguard": "RINO"
  },
  "wealth": "normal",
  "seats": {
    "BTN": { "name": "赌徒阿飞", "kernel": "gambler", "archetype": "muggle", "mood": "euphoric" },
    "SB": { "name": "铁面张", "kernel": "rock", "archetype": "muggle", "mood": "calm" }
  }
}
</ACE0_BATTLE>
第二把（输了之后情绪变化，只需改 mood）：
<ACE0_BATTLE>
{
  "hero": {
    "vanguard": "KAZU",
    "rearguard": "RINO"
  },
  "wealth": "normal",
  "seats": {
    "BTN": { "name": "赌徒阿飞", "kernel": "gambler", "archetype": "muggle", "mood": "tilt" },
    "SB": { "name": "铁面张", "kernel": "rock", "archetype": "muggle", "mood": "fearful" }
  }
}
</ACE0_BATTLE>
</ace0_battle_rules>
